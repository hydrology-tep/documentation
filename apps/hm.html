
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.3. Hydrological Modelling &#8212; Hydrology Thematic Exploitation Platform 2.3.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.4/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.4. Water Quality" href="wq.html" />
    <link rel="prev" title="6.2. Flood monitoring" href="fm.html" />
    <link rel="stylesheet" href="../_static/terradue.css" type="text/css" />
    <script src="../_static/affixTrick.js"></script>
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">


  </head>
  <body role="document">

<!-- <header>
	<div class="container">
		<a href="http://www.terradue.com" target="_blank"><img id="logo" src="../_static/t2Logo.png"></a>
		<div id="t2-random-slogan">digital earth scalers</div>
	</div>
</header> -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top"><!-- navbar-fixed-top-->
    <div class="container">
      <div class="navbar-header pull-right">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.terradue.com" target="_blank"><img id="logo" src="../_static/t2Logo.png"></a>
        <!--<a class="navbar-brand" href="../index.html"><img class="navbar-brand-logo" src="../_static/logo-geohazard.png" alt="sandbox-logo"/></a>-->
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
	    <a class="navbar-brand" href="https://hydrology-tep.eu" target="_blank"><img id="logo" src="../_static/TEP_hydrology_logo.png"></a>
            <li class="divider-vertical"></li>
<!--             <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        <b>2.3.3</b><b class="caret"></b>
    </a>
    <ul class="dropdown-menu globaltoc">
        <li><a href="/devel">1.2 (Devel)</a></li>
        <li><a href="/stable">1.1 (Stable)</a></li>
    </ul>
</li> -->

            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-start-manual/index.html">2. Quick Start Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community-guide/index.html">3. Community Portal User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">4. Community Portal Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">5. Community Advanced User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. Thematic Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirement/index.html">7. Requirement Traceability</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">6.3. Hydrological Modelling</a><ul>
<li><a class="reference internal" href="#access-to-the-thematic-application">6.3.1. Access to the thematic application</a></li>
<li><a class="reference internal" href="#selecting-the-area-of-interest-based-on-drainage-basins-and-upstream-area">6.3.2. Selecting the Area of Interest based on drainage basins and upstream area</a><ul>
<li><a class="reference internal" href="#select-a-sub-basin-and-its-upstream-area-in-the-geobrowser">6.3.2.1. Select a sub-basin and it’s upstream area in the Geobrowser</a></li>
<li><a class="reference internal" href="#spatial-filtering-of-eo-data-using-the-hydrological-model-sub-basins">6.3.2.2. Spatial filtering of EO data using the hydrological model sub-basins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-the-niger-hype-historical-simulation-processing-service">6.3.3. Run the Niger-HYPE historical simulation Processing Service</a><ul>
<li><a class="reference internal" href="#running-the-niger-hype-historical-simulation-processing-service">6.3.3.1. Running the Niger-HYPE historical simulation processing service</a></li>
<li><a class="reference internal" href="#results-from-the-niger-hype-historical-simulation-service">6.3.3.2. Results from the Niger-HYPE historical simulation service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-the-niger-hype-forecast-processing-service">6.3.4. Run the Niger-HYPE Forecast Processing Service</a><ul>
<li><a class="reference internal" href="#running-the-niger-hype-forecast-processing-service">6.3.4.1. Running the Niger-HYPE forecast processing service</a></li>
<li><a class="reference internal" href="#results-from-the-niger-hype-forecast-processing-service">6.3.4.2. Results from the Niger-HYPE forecast processing service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-the-eo-data-pre-processing-processing-service">6.3.5. Run the EO Data Pre-processing Processing Service</a><ul>
<li><a class="reference internal" href="#running-the-niger-hype-eo-data-pre-processing-service">6.3.5.1. Running the Niger-HYPE EO data pre-processing service</a></li>
<li><a class="reference internal" href="#results-from-the-niger-hype-eo-data-pre-processing-service">6.3.5.2. Results from the Niger-HYPE EO data pre-processing service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-the-return-period-magnitude-analysis-processing-service">6.3.6. Run the Return Period Magnitude Analysis Processing service</a><ul>
<li><a class="reference internal" href="#running-the-hype-return-period-analysis-processing-service">6.3.6.1. Running the HYPE Return Period Analysis processing service</a></li>
<li><a class="reference internal" href="#results-from-the-hype-return-period-analysis-processing-service">6.3.6.2. Results from the HYPE Return Period Analysis processing service</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="fm.html" title="Previous Chapter: 6.2. Flood monitoring"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 6.2. Flood monitoring</span>
    </a>
  </li>
  <li>
    <a href="wq.html" title="Next Chapter: 6.4. Water Quality"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">6.4. Water Quality &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li><div id="sourcelink">
  <a href="https://github.com/hydrology-tep/documentation/blob/develop/source/apps/hm.rst" rel="nofollow" target="_blank"><span class='githubLogo'></span>Source</a>
</div></li>
            
          </ul>
        </div>
    </div>
</div>
<div id="navbarSpacer"></div>

<div class="container">
  <div class="row">
<!--<div class="alert alert-danger alert-error alert-dismissable" style="margin-left: 15px; margin-right: 15px;">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <p class="first admonition-title">
        Warning
    </p>
    <p class="last">
        This guide is under development. The material on this page needs to be reviewed for completeness and accuracy. This guide may have not been updated yet from the last release.
    </p>
</div>-->

      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenavNew" role="complementary"><p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-start-manual/index.html">2. Quick Start Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community-guide/index.html">3. Community Portal User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">4. Community Portal Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">5. Community Advanced User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. Thematic Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wois_app.html">6.1. WOIS CloudToolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="fm.html">6.2. Flood monitoring</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.3. Hydrological Modelling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#access-to-the-thematic-application">6.3.1. Access to the thematic application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-the-area-of-interest-based-on-drainage-basins-and-upstream-area">6.3.2. Selecting the Area of Interest based on drainage basins and upstream area</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#select-a-sub-basin-and-its-upstream-area-in-the-geobrowser">6.3.2.1. Select a sub-basin and it’s upstream area in the Geobrowser</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spatial-filtering-of-eo-data-using-the-hydrological-model-sub-basins">6.3.2.2. Spatial filtering of EO data using the hydrological model sub-basins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-niger-hype-historical-simulation-processing-service">6.3.3. Run the Niger-HYPE historical simulation Processing Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-the-niger-hype-historical-simulation-processing-service">6.3.3.1. Running the Niger-HYPE historical simulation processing service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-from-the-niger-hype-historical-simulation-service">6.3.3.2. Results from the Niger-HYPE historical simulation service</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-niger-hype-forecast-processing-service">6.3.4. Run the Niger-HYPE Forecast Processing Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-the-niger-hype-forecast-processing-service">6.3.4.1. Running the Niger-HYPE forecast processing service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-from-the-niger-hype-forecast-processing-service">6.3.4.2. Results from the Niger-HYPE forecast processing service</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-eo-data-pre-processing-processing-service">6.3.5. Run the EO Data Pre-processing Processing Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-the-niger-hype-eo-data-pre-processing-service">6.3.5.1. Running the Niger-HYPE EO data pre-processing service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-from-the-niger-hype-eo-data-pre-processing-service">6.3.5.2. Results from the Niger-HYPE EO data pre-processing service</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-return-period-magnitude-analysis-processing-service">6.3.6. Run the Return Period Magnitude Analysis Processing service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-the-hype-return-period-analysis-processing-service">6.3.6.1. Running the HYPE Return Period Analysis processing service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-from-the-hype-return-period-analysis-processing-service">6.3.6.2. Results from the HYPE Return Period Analysis processing service</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wq.html">6.4. Water Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="wl.html">6.5. Water Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="swbm.html">6.6. Small Water Body Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="mydata_app.html">6.7. Manage my data</a></li>
<li class="toctree-l2"><a class="reference internal" href="testmyproc_app.html">6.8. Test my processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="myapp.html">6.9. My apps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../requirement/index.html">7. Requirement Traceability</a></li>
</ul>
<div id="sourcelink">
  <a href="https://github.com/hydrology-tep/documentation/blob/develop/source/apps/hm.rst" rel="nofollow" target="_blank"><span class='githubLogo'></span>Source</a>
</div>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>

    <div class="col-md-9">
      
  <div class="section" id="hydrological-modelling">
<span id="hm"></span><h1>6.3. Hydrological Modelling<a class="headerlink" href="#hydrological-modelling" title="Permalink to this headline">¶</a></h1>
<p>The aim of the Hydrological Modelling Application is to provide a platform for assimilation of EO data in hydrological models. It includes processing services for running a hydrological model in hindcast and forecast mode with or without satellite and in-situ data assimilation, accessing meteorological data from external data services, preparing EO data for assimilation in the hydrological models, basic visualization and statistical analysis of model results.</p>
<p>The Hydrological Modelling Application is implemented using the Niger-HYPE model (v2.21) providing simulations of river discharge, lake water level and outflow, as well as land surface water balance components (precipitation, evapotranspiration, runoff, and soil water content) for the Niger river basin. The service collects meteorological forcing data from the SMHI Global Forcing Data service for simulations of historical periods from 1979 until current time, and short to medium range forecasts (1-10 days) since 2016-06-01. The following four Processing services are included in the application:</p>
<blockquote>
<div><ul class="simple">
<li>Niger-Hype simulation of historical period</li>
<li>Niger-HYPE forecast</li>
<li>EO-data pre-processing</li>
<li>Return Period magnitude Analysis</li>
</ul>
</div></blockquote>
<p>Further details about the Niger-HYPE model <a class="reference external" href="http://hypeweb.smhi.se/niger-hype">http://hypeweb.smhi.se/niger-hype</a>
Source code and information about the HYPE model see <a class="reference external" href="http://hypecode.smhi.se">http://hypecode.smhi.se</a>
Documentation and wiki about HYPE that can be useful in the following hands-on exercises is found here <a class="reference external" href="http://www.smhi.net/hype/wiki/doku.php">http://www.smhi.net/hype/wiki/doku.php</a></p>
<div class="section" id="access-to-the-thematic-application">
<h2>6.3.1. Access to the thematic application<a class="headerlink" href="#access-to-the-thematic-application" title="Permalink to this headline">¶</a></h2>
<p>The Hydrological Modelling application is accessed from the home page of the Hydrology TEP community portal:</p>
<ol class="arabic simple">
<li>Enter the <strong>HEP portal</strong> and <strong>sign in</strong> with your HEP community user account <a class="reference external" href="https://hydrology-tep.eu">https://hydrology-tep.eu</a></li>
<li>Open the list of <strong>Thematic applications</strong> with the view_apps link below the Discover Thematic Apps icon.</li>
<li>Find the link to the Hydrological_modelling application (Open App):</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm.png"><img alt="../_images/apps_hm.png" src="../_images/apps_hm.png" style="width: 683.2px; height: 249.6px;" /></a>
</div>
<ol class="arabic simple" start="4">
<li>The initial view of the hydrological modelling application showing the <strong>Niger-River drainage basin in the Geobrowser</strong> as represented in the Niger-HYPE <a class="footnote-reference" href="#id2" id="id1">[1]</a> model.</li>
</ol>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>See <a class="reference external" href="http://hypecode.smhi.se">http://hypecode.smhi.se</a> and <a class="reference external" href="http://hypeweb.smhi.se/nigerhype">http://hypeweb.smhi.se/nigerhype</a> for more details about the hydrological model HYPE and the Niger-River HYPE model application, respectively.</td></tr>
</tbody>
</table>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_initial_view.png"><img alt="../_images/apps_hm_initial_view.png" src="../_images/apps_hm_initial_view.png" style="width: 670.4px; height: 359.2px;" /></a>
</div>
<ol class="arabic simple" start="5">
<li><strong>Selection of area of interest</strong> based on drainage basins and upstream area:<ol class="loweralpha">
<li>Integrated in the Geobrowser is a functionality to select area of interest for EO data exploitation based on the hydrological model sub-basins and their upstream area</li>
</ol>
</li>
<li><strong>Hydrological Modelling Processing Services</strong> are found on the <strong>Processing Services</strong> tab on the right side of the geobrowser:<ol class="loweralpha">
<li>Niger-Hype simulation of historical period</li>
<li>Niger-HYPE forecast</li>
<li>EO-data pre-processing</li>
<li>Return Period magnitude Analysis</li>
</ol>
</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_initial_view2.png"><img alt="../_images/apps_hm_initial_view2.png" src="../_images/apps_hm_initial_view2.png" style="width: 741.6px; height: 341.6px;" /></a>
</div>
<p>Instructions how to run the different processing services are given in the following sections.</p>
</div>
<div class="section" id="selecting-the-area-of-interest-based-on-drainage-basins-and-upstream-area">
<h2>6.3.2. Selecting the Area of Interest based on drainage basins and upstream area<a class="headerlink" href="#selecting-the-area-of-interest-based-on-drainage-basins-and-upstream-area" title="Permalink to this headline">¶</a></h2>
<p>The hydrological model sub-basin layer makes it possible to select area of interest based on drainage basins and upstream area.</p>
<p>This functionality is dependent on the drainage basin data set available on the portal.</p>
<p>Currently, the drainage basin of the Niger river as represented in the Niger-HYPE model is the only dataset loaded into the HEP community portal.</p>
<div class="section" id="select-a-sub-basin-and-its-upstream-area-in-the-geobrowser">
<h3>6.3.2.1. Select a sub-basin and it’s upstream area in the Geobrowser<a class="headerlink" href="#select-a-sub-basin-and-its-upstream-area-in-the-geobrowser" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Zoom in to the area of interest and select a sub-basin by clicking in the map (left mouse button) <a class="footnote-reference" href="#id4" id="id3">[2]</a> . The selected sub-basin is highlighted in green, and the upstream areas in yellow.</li>
<li>To select another sub-basin, click in another non-highlighted basin (it’s not possible to select a sub-basin from the current selected upstream area)</li>
</ol>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>The EO data coverage polygons may be blocking the sub-basin polygons. Solution, see <em>Known issues</em>.</td></tr>
</tbody>
</table>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_subbasin.png"><img alt="../_images/apps_hm_subbasin.png" src="../_images/apps_hm_subbasin.png" style="width: 727.2px; height: 396.0px;" /></a>
</div>
<ol class="arabic simple" start="3">
<li>Click a second time in the selected sub-basin and a pop-up dialogue will appear with information about the sub-basins identifier in the Niger-HYPE model.</li>
</ol>
<p>There is also functionality for applying spatial filter on the EO data selection, see further below.</p>
<ol class="arabic simple" start="4">
<li>Known issues<ol class="loweralpha">
<li>It is not possible to select sub-basins that are covered by an EO data coverage polygon. Try to reduce the EO data selection by changing data set or by using the time filter.</li>
<li>To select a sub-basin in the current selected upstream area, the selected region must first be de-selected, which can done by selecting a non-highlighted sub-basin in another part of the model domain.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="spatial-filtering-of-eo-data-using-the-hydrological-model-sub-basins">
<h3>6.3.2.2. Spatial filtering of EO data using the hydrological model sub-basins<a class="headerlink" href="#spatial-filtering-of-eo-data-using-the-hydrological-model-sub-basins" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Select the sub-basin of interest by mouse click in the geobrowser.</li>
<li>Select the EO data of interest from the EO data drop-down menu at the top-right of the portal.</li>
<li>Click a second time in the sub-basin of interest, and apply the spatial filter in the pop-up dialogue.</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_subbasin_filtering.png"><img alt="../_images/apps_hm_subbasin_filtering.png" src="../_images/apps_hm_subbasin_filtering.png" style="width: 680.0px; height: 457.6px;" /></a>
</div>
<p>The method will select the EO data that are covering the selected sub-basin only.</p>
<p>By clicking somewhere in the upstream area, the spatial filter will be applied using the upstream area.</p>
<p>The selected data sets can be added to the Feature basket and used for processing within the other thematic applications.</p>
</div>
</div>
<div class="section" id="run-the-niger-hype-historical-simulation-processing-service">
<h2>6.3.3. Run the Niger-HYPE historical simulation Processing Service<a class="headerlink" href="#run-the-niger-hype-historical-simulation-processing-service" title="Permalink to this headline">¶</a></h2>
<p>This hands-on exercise describes how to make simulation with the Niger-HYPE historical period service with or without EO data assimilation.</p>
<div class="section" id="running-the-niger-hype-historical-simulation-processing-service">
<h3>6.3.3.1. Running the Niger-HYPE historical simulation processing service<a class="headerlink" href="#running-the-niger-hype-historical-simulation-processing-service" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open the Niger-HYPE historical simulation service and Select name for you job in the <strong>Job title</strong> parameter field</li>
<li>(mandatory) Set the start of the simulation period in the <strong>Start of simulation (yyyy-mm-dd)*</strong> input parameter field (obligatory).<ol class="loweralpha">
<li>In the example 2016-04-01 (the start of the rainy season in the Niger river basin is usually in the beginning of April)</li>
</ol>
</li>
<li>(mandatory) Set the end of simulation period in the End of simulation (yyyy-mm-dd)* input parameter field:<ol class="loweralpha">
<li>In the example 2017-03-01 to produce a one-year simulation.</li>
</ol>
</li>
<li>(mandatory) Select outputs from the fixed list of available simulated variables in the <strong>Output variables</strong> drop down menu:<ol class="loweralpha">
<li>The output variable list is build up of three components on the format Variable Name (unit) [4-letter code used internally in the HYPE model]</li>
<li>Click the + sign to enable selection of more variables.</li>
</ol>
</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_historical_simulation.png"><img alt="../_images/apps_hm_historical_simulation.png" src="../_images/apps_hm_historical_simulation.png" style="width: 295.2px; height: 613.6px;" /></a>
</div>
<ol class="arabic simple" start="5">
<li>(mandatory) Select output locations (sub-basins in the Niger-HYPE model) from a fixed list of named locations in the <strong>Output sub-basins</strong> drop down menu:<ol class="loweralpha">
<li>The output location list includes all sub-basins in the Niger-HYPE model where there is a discharge station (Qstn) or a outlet lake (Lake). The name of the discharge station/lake and the sub-basin identifier are included in the drop down list.</li>
</ol>
</li>
<li>(optional) Select additional output locations that are not listed in the Output sub-basins list by entering the sub-basin identifier in the <strong>Output sub-basins (SUBID)</strong> input field:<ol class="loweralpha">
<li>The sub-basin identifier can be found for any basin in the model by clicking on the basin in the map browser. It is also possible to set the sub-basin identifier in the input field by using the magic tool in the left side of the input field and select “subbasin id”</li>
</ol>
</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_historical_simulation2.png"><img alt="../_images/apps_hm_historical_simulation2.png" src="../_images/apps_hm_historical_simulation2.png" style="width: 734.4px; height: 294.4px;" /></a>
</div>
<ol class="arabic simple" start="7">
<li>(optional) Add and so-called Xobs-file with pre-processed EO or in-situ data to the model simulation by dragging an available data set from your Features basket:<ol class="loweralpha">
<li>An example can be found in a public data package called Niger-HYPE RPM check data set, which includes a data set called Xobs-eodata.txt with a time-series of lake water level from Lake Shiroro generated with the Water Level application.</li>
</ol>
</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_historical_simulation3.png"><img alt="../_images/apps_hm_historical_simulation3.png" src="../_images/apps_hm_historical_simulation3.png" style="width: 752.8px; height: 222.4px;" /></a>
</div>
<ol class="arabic simple" start="8">
<li>(optional) Switch Data Assimilation on or off in the <strong>Assimilation on/off</strong> input field:<ol class="loweralpha">
<li>Switching assimilation on will trigger an Ensemble Kalman filter assimilation run, where the data inserted in the previous step is used to adjust the model simulation towards the assimilated data.</li>
</ol>
</li>
<li>(mandatory of Assimilation is On, otherwise optional) Select which variables to be assimilated in the <strong>Assimilated observations</strong> input field. Currently it is only possible to select one of two options:<ol class="loweralpha">
<li>Lake Water Level Altimetry AOWL WCOM (altimetry based lake water levelis assimilated if a variable called AOWL is present in the Xobs-files entered in the previous input field)</li>
<li>Openloop ensemble simulation without assimilation OPEN LOOP (the same type of ensemble simulation is generated as for an assimilation run, however no observations are assimilated).</li>
</ol>
</li>
</ol>
<p>Please note that the ensemble simulations generated when switching Assimilation On requires much more processing time (at least 10 times more) compared to Assimilation Off. This is due to two reasons:</p>
<blockquote>
<div><ul class="simple">
<li>The Ensemble Kalman filter method is based on ensemble simulations. Currently, the Niger-HYPE application is configured to include 10 members in the model ensemble (which is actually already a rather small number, 50 or more would be better).</li>
<li>The model ensemble must also have enough variability to be able to adjust to the observations in a realistic way. Currently, the only method used here to generate ensemble spread is to add random perturbations to the meteorological forcing data (precipitation and temperature). Thus, it becomes important to include at least one rainy season in a warm-up period before the assimilation period. Consequently, the selected start of the simulation period is automatically adjusted to meet this criteria.</li>
</ul>
</div></blockquote>
<p>It is advisable to first make a simulation without assimilation to check results, and also the bias between simulated variable (WCOM in the example) and the observations to assimilate (AOWL in the example) and possibly correct the offset input parameter in the EO data pre-processing (see section 6.3.5 below).</p>
</div>
<div class="section" id="results-from-the-niger-hype-historical-simulation-service">
<h3>6.3.3.2. Results from the Niger-HYPE historical simulation service<a class="headerlink" href="#results-from-the-niger-hype-historical-simulation-service" title="Permalink to this headline">¶</a></h3>
<p>The results from the processing service is described in the table below. The prefix numbers are used as a trick to order the output files in a certain order.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Output files</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>001_[subid]_[name].png
001_[subid]_[name].pngw</td>
<td>Quicklooks (PNG format with associated word file PNGW for visualization in the map browser)
with time-series plots of simulated variable [name] for sub-basin [subid], where [name] corresponds
to the 4-letter code for HYPE model variables and [subid] to the Niger-HYPE sub-basin identifier.</td>
</tr>
<tr class="row-odd"><td>001_map[name].png
001_map[name].pngw</td>
<td>Quicklook (PNG format) with maps of variable [name] with mean simulated variable during the
simulation period, where [name] corresponds to the 4-letter code for HYPE model variables.</td>
</tr>
<tr class="row-even"><td>002_[subid].csv
003_[subid].txt</td>
<td><dl class="first docutils">
<dt>Text files with time series output for selected sub-basins:</dt>
<dd><a href="#id5"><span class="problematic" id="id6">*</span></a>.csv provide data in the H-TEP standard csv format
<a href="#id7"><span class="problematic" id="id8">*</span></a>.txt provide data in the HYPE basin-output format.</dd>
</dl>
<p class="last">Each text file includes data for the entire simulation period (daily values) for all selected
output variables for one sub-basin.</p>
</td>
</tr>
<tr class="row-odd"><td>004_map[NAME].txt</td>
<td>Text file with average (full simulation period) simulated value for a selected variable specified
by the file name (4-letter variable names, see HYPE wiki pages). Each row represents one subbasin
of the model.</td>
</tr>
<tr class="row-even"><td>005_time[NAME].txt</td>
<td>Text file with average (full simulation period) simulated value for a selected variable specified
by the file name (4-letter variable names, see HYPE wiki pages). Each row represents one subbasin
of the model.</td>
</tr>
<tr class="row-odd"><td>006_simass.txt
006_subass.txt</td>
<td>Text file with assessment of the agreement between simulated and observed data (depending on which
observed variables added to the simulation through the Xobs-files).</td>
</tr>
<tr class="row-even"><td>009_hyss_000_YYMMDD_hhmm
.log</td>
<td>Log-file for the HYPE model simulation</td>
</tr>
<tr class="row-odd"><td>hypeapps-historical-
logfile.txt</td>
<td>Log-file from the processing service.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="run-the-niger-hype-forecast-processing-service">
<h2>6.3.4. Run the Niger-HYPE Forecast Processing Service<a class="headerlink" href="#run-the-niger-hype-forecast-processing-service" title="Permalink to this headline">¶</a></h2>
<p>This hands-on exercise describes how to make a forecast simulation with the Niger-HYPE historical period service with or without EO data assimilation.
Please note that several steps are identical to the Niger-HYPE historical simulation service. In this case, the hands-on guide will refer to section 6.3.3</p>
<p>The forecast service always makes two simulations - first a 3-month warm-up simulation (the hindcast) ending on the day before the start of the 10-day forecast simulation (the forecast). The outputs from hindcast and forecast simulations are published separately in the application results. The first day of the forecast simulation is called the Forecast issue date, and is one of the input parameters to the applications. Data is saved in the system to enable forecasts for issue dates between 2016-06-01 until the day before the current date.The application may automatically adjust the forecast issue date to an earlier date if the update of the meteorological forcing data for some reason is lagging behind (update is usually made around noon every day).</p>
<div class="section" id="running-the-niger-hype-forecast-processing-service">
<h3>6.3.4.1. Running the Niger-HYPE forecast processing service<a class="headerlink" href="#running-the-niger-hype-forecast-processing-service" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open the Niger-HYPE forecast service and select <strong>Job Title</strong> (same procedure as in 6.3.3)</li>
<li>(mandatory) Set the start of the 10 day forecast simulation in the <strong>Forecast issue date (yyyy-mm-dd)</strong> input field.</li>
<li>(mandatory) Select <strong>output variables</strong> and <strong>output locations</strong> (same procedure as in 6.3.3)</li>
<li>(optional) Enter a custom made <strong>Return Period Warning Level File</strong> for the calculation of river discharge forecast warning levels (or leave <strong>&#8220;default&#8221;</strong> to use the default data embedded in the aplpication, representing 2,5, and 30 years return period for warning levels 1, 2, and 3, respectively, based on a historical simulation 1979-2013).</li>
<li>(optional) Set parameters for <strong>Xobs inputs</strong> and <strong>Data assimilation</strong> (same procedure as for 6.3.3)</li>
</ol>
<div class="img-border figure">
<a class="reference internal image-reference" href="../_images/apps_hm_forecast.png"><img alt="../_images/apps_hm_forecast.png" src="../_images/apps_hm_forecast.png" style="width: 271.2px; height: 531.2px;" /></a>
</div>
</div>
<div class="section" id="results-from-the-niger-hype-forecast-processing-service">
<h3>6.3.4.2. Results from the Niger-HYPE forecast processing service<a class="headerlink" href="#results-from-the-niger-hype-forecast-processing-service" title="Permalink to this headline">¶</a></h3>
<p>First of all, the Niger-HYPE forecast service produces similar results as the Niger-HYPE historical service - all variables listed in the section 6.3.3.2 are produced both for the hindcast and the forecast simulation period, except for the quicklooks. Results are sorted in subfolders called forecast and hindcast, respectively.</p>
<p>In addition, three specific forecast outputs are generated by the forecast service, and at the end also a processing service log file:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Output files</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>001_[subid]_discharge-forecast.png
001_[subid]_discharge-forecast.pngw</td>
<td>River discharge forecast time-series plots (png quicklooks) for the selected output sub-basins
[subid], with the return-period levels based warning levels plotted in the background. The
quicklooks are visualized in the map browser located with the lower left corner in the
centre-coordinate of the corresponding basin.</td>
</tr>
<tr class="row-odd"><td>001_mapWarningLevel.png
001_mapWarningLevel.pngw</td>
<td>River discharge forecast warning level maps (png quicklooks), showing the maximum forecasted river
discharge warning level in each sub-basin of the Niger-HYPE model. The quicklook is displayed in
the map browser scaled to the current map scale and centered on the Niger River basin.</td>
</tr>
<tr class="row-even"><td>004_mapWarningLevel.txt</td>
<td>Maximum forecasted river discharge warning level in the HYPE map output text format
(same format as 004_map[NAME].txt)</td>
</tr>
<tr class="row-odd"><td>hypeapps-forecast-logfile.txt</td>
<td>Log-file from the processing service.</td>
</tr>
</tbody>
</table>
<a class="reference internal image-reference" href="../_images/apps_hm_forecast_river_discharge1.png"><img alt="../_images/apps_hm_forecast_river_discharge1.png" src="../_images/apps_hm_forecast_river_discharge1.png" style="width: 45%;" /></a>
<a class="reference internal image-reference" href="../_images/apps_hm_forecast_river_discharge2.png"><img alt="../_images/apps_hm_forecast_river_discharge2.png" src="../_images/apps_hm_forecast_river_discharge2.png" style="width: 45%;" /></a>
<p>Example of River discharge forecast warning level map output (left) and River discharge forecast time-series output (right).</p>
</div>
</div>
<div class="section" id="run-the-eo-data-pre-processing-processing-service">
<h2>6.3.5. Run the EO Data Pre-processing Processing Service<a class="headerlink" href="#run-the-eo-data-pre-processing-processing-service" title="Permalink to this headline">¶</a></h2>
<p>The purpose of the service is to transform data sets generated by the H-TEP EO data services to the time-series format required by the hydrological model. This include both spatial and temporal aggregation of the EO data sets. Currently, the service is configured to do temporal aggregation of data from the Water Level service, to provide time series with data representative for a selected Niger-HYPE sub-basin. The output is a textfile in the specific Xobs text format required to be assimilated in the HYPE model (see further on the HYPE wiki pages).</p>
<div class="section" id="running-the-niger-hype-eo-data-pre-processing-service">
<h3>6.3.5.1. Running the Niger-HYPE EO data pre-processing service<a class="headerlink" href="#running-the-niger-hype-eo-data-pre-processing-service" title="Permalink to this headline">¶</a></h3>
<p>This section provides a brief guideline on how to use the Niger-HYPE EO data pre-processing processing service to prepare data from the Water Level service for assimilation in the Niger-HYPE model:</p>
<ol class="arabic simple">
<li>(mandatory) Make sure you have available in your <strong>Feature basket</strong> a relevant <strong>data set with water level time-series data generated by the H-TEP Water Level service</strong>.<ol class="loweralpha">
<li>An example is available in the public data package called Niger-HYPE RPM check data set, which includes a data set called lakes_summary_multi_SN3_Shiroro_mask_1_L2.csv, with a time-series of lake water level from Lake Shiroro (subid 212) generated with the Water Level application.</li>
<li>This data package also contains the expected output of this exercise called Xobs-eodata.txt, which can be used to check the output.</li>
</ol>
</li>
<li>Enter the EO data pre-processing service, and edit the job name in the <strong>Job Title</strong> input field.</li>
<li>(mandatory) Drag the Water level data set from Feature basket into the <strong>Water Level Time-series Data</strong>, EO or In-situ (<a href="#id9"><span class="problematic" id="id10">*</span></a>.csv) input field.<ol class="loweralpha">
<li>Use the lakes_summary_multi_SN3_Shiroro_mask_1_L2.csv from the example or your own data set.</li>
</ol>
</li>
<li>(mandatory) Set the sub-basin identifier corresponding to the EO data set in the Sub-basin identifier - one for each dataset input field<ol class="loweralpha">
<li>Lake Shiroro corresponds to Niger-HYPE sub-basin 212.</li>
</ol>
</li>
<li>(mandatory) Select the HYPE model variable corresponding to the EO data in the <strong>HYPE variables - one for each dataset</strong> input field:<ol class="loweralpha">
<li>Lake water level altimetry (m) AOWL for altimetry data, or</li>
<li>Lake water level in-situ (m) WSTR for in-situ data</li>
</ol>
</li>
<li>(mandatory) Set the vertical <strong>Offset correction</strong> of the EO (or in-situ) data set:<ol class="loweralpha">
<li>This parameter is useful for reducing the mean bias between the model and the observations - which is important if the data is intended for assimilation in the model. The data assimilation method can only adjust the bias to a certain extent, and is more efficient to adjust temporal errors if the mean bias is small.</li>
<li>The offset is an additive correction of the EO data, and can be a negative (EO data is corrected downwards) or positive number (EO data is corrected upwards).</li>
<li>It is recommended to make an initial comparison with the simulated lake water level using offset=0, and then redo the pre-processing with a correction factor estimated from this initial comparison before assimilating the EO data in the model.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="results-from-the-niger-hype-eo-data-pre-processing-service">
<h3>6.3.5.2. Results from the Niger-HYPE EO data pre-processing service<a class="headerlink" href="#results-from-the-niger-hype-eo-data-pre-processing-service" title="Permalink to this headline">¶</a></h3>
<p>The results from the EO data pre-processing service is a text file called <strong>Xobs-eodata.txt</strong> containing the analysed EO data in the HYPE models Xobs-format:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>one row for each date (please note how the dates with missing data is padded with missing value identifier -9999)</li>
<li>and one column for each variable and sub-basin (please note the format of the two header rows containing the sub-basin identifier and the 4-letter coded HYPE model variable names, respectively).</li>
<li>Move the xobs-eobs.txt from the results container to the Feature basket if you intend to use it for assimilation in the Niger-HYPE modelling processors (historical or forecast).</li>
</ol>
</div></blockquote>
<p>In addition, there is a processor log file generated, which indicate if some input caused unexpected behaviour of the processor.</p>
</div>
</div>
<div class="section" id="run-the-return-period-magnitude-analysis-processing-service">
<h2>6.3.6. Run the Return Period Magnitude Analysis Processing service<a class="headerlink" href="#run-the-return-period-magnitude-analysis-processing-service" title="Permalink to this headline">¶</a></h2>
<p>The purpose of the HYPE Return Period Analysis processing service is to <strong>estimate annual maximum values</strong> of for instance daily mean river discharge or precipitation <strong>at selected return periods (years)</strong>. These return period levels (or magnitudes) can be used as input to the Niger-HYPE forecast processing service as thresholds for forecast warning levels.  Currently, the Niger-HYPE forecast service will only use return level estimates for river discharge, but the HYPE Return period Analysis service can be used to analyse any output variable from the HYPE model (given in the time output format, which is generated by the Niger-HYPE historical processing service.</p>
<div class="section" id="running-the-hype-return-period-analysis-processing-service">
<h3>6.3.6.1. Running the HYPE Return Period Analysis processing service<a class="headerlink" href="#running-the-hype-return-period-analysis-processing-service" title="Permalink to this headline">¶</a></h3>
<p>This section provide a brief guide on how to make use of the return period analysis service.</p>
<ol class="arabic simple">
<li>(mandatory) Make sure you have <strong>time-series outputs from the Niger-HYPE historical simulations</strong> processing service available in the Feature basket:<ol class="loweralpha">
<li>It should be a dataset in the HYPE time-output format, time[NAME].txt</li>
<li>It should cover as long time-period as possible (if possible, close to the maximum return period you would like to estimate level for)</li>
<li>Examples are available in the public data package Niger-HYPE RPM check data set, for instance the river discharge dataset 005_timeCOUT.txt</li>
</ol>
</li>
<li>Open the HYPE Return Period Analysis service and edit the <strong>Job Title</strong> if needed.</li>
<li>(mandatory) Drag the selected time-output data from the Feature basket into the <strong>HYPE timeoutput data (time****.txt)</strong> input field.</li>
<li>(mandatory) Set the requested return periods for the analysis in the <strong>Return Periods (years)</strong> input field (for instance 2,5,30).</li>
<li>Run the application</li>
</ol>
</div>
<div class="section" id="results-from-the-hype-return-period-analysis-processing-service">
<h3>6.3.6.2. Results from the HYPE Return Period Analysis processing service<a class="headerlink" href="#results-from-the-hype-return-period-analysis-processing-service" title="Permalink to this headline">¶</a></h3>
<p>The result of the HYPE Return Period Analysis processing service is a textfile with estimated levels (annual maximum values of the input data) at different return periods (years):</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>Each row correspond to a sub-basin in the Niger-HYPE model, identified by the sub-basin identifier in the first column.</li>
<li>The remaining columns contain the estimated levels for the return periods (years) identified from the header row.</li>
<li>Copy the result to your Feature basket if the file should be used as input to the Niger-HYPE Forecast processing service.</li>
</ol>
</div></blockquote>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
	<div class="container">
		<img src="../_static/t2LogoLittleWhite.png">
		&nbsp;&nbsp;&nbsp;Copyright 2006-2014 &copy; Terradue. All Rights Reserved. Please send comments to <a href="mailto:info [at] terradue [dot] com">info</a>. <p class="pull-right">This site is hosted by <a href="http://www.terradue.com">Terradue</a>.</p>
	</div>
</footer>

  </body>
</html>